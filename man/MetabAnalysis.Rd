% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MetabAnalysis.R
\name{MetabAnalysis}
\alias{MetabAnalysis}
\title{Analyze Metabolite Concentrations Against Healthy Reference Ranges}
\usage{
MetabAnalysis(
  data_input = NULL,
  age = NULL,
  sample_type = NULL,
  match_by = c("HMDB_ID", "Metabolite_Name"),
  ref_data_override = NULL
)
}
\arguments{
\item{data_input}{A data frame or a character string representing the file path
to a CSV file containing metabolite concentrations. Rows must represent
individual metabolites, and \strong{the row names must be the metabolite identifiers}
(HMDB IDs or Metabolite Names). If names were used instead of IDS, please make sure
they match the reference data's name exactly(obtained by GetRefRanges()).
Columns represent samples.}

\item{age}{A numeric vector where each element represents the age (in years)
for the corresponding sample column in \code{data_input}. The length of this
vector must match the number of sample columns.}

\item{sample_type}{A character vector specifying the biospecimen type for each sample.
The length of this vector must match the number of samples.
(e.g., \code{"Blood/Serum/Plasma"}, \code{"Urine"}, \code{"CSF"}).}

\item{match_by}{A character string indicating whether the \strong{row names} in
\code{data_input} represent "HMDB_ID" (default) or "Metabolite_Name". Default
set to be "HMDB_ID".}

\item{ref_data_override}{An optional data frame to use as the reference, bypassing the \code{GetRefRanges()} call.}
}
\value{
A data frame with the same structure as \code{data_input} (rows as
  metabolites, columns as samples), where the numeric concentration values are
  replaced by character classifications: "Normal", "High", or "Low". If a
  metabolite cannot be matched or no age-appropriate reference is found,
  the classification will be "Missing Reference".
}
\description{
Compares a user-supplied metabolite concentration dataset against the
standardized healthy reference ranges provided by \code{GetRefRanges()} based
on Human Metabolome Database(HMDB).
It returns a data frame showing the classification of each metabolite's
concentration in each sample as "Normal," "High," or "Low." If reference
range not available, it will show "Missing Reference" instead.
}
\details{
This function assumes the user data has been formatted so that metabolite
identifiers are used as \strong{row names} and all column values are numeric
concentrations for different samples. The function uses the \code{match_by}
parameter to determine which column in the reference table to match the row names against.

**Required Structure of \code{data_input}:**
\itemize{
  \item **Row Names:** Must be HMDB IDs (e.g., "HMDB0000001") or Metabolite Names (e.g., "Alanine").
  \item **Columns:** Must be numeric concentration values for each sample.
}
}
\examples{
\dontrun{
# Example 1
# Make a mock reference data
mock_reference_data <- data.frame(
  'HMDB_ID' = c("HMDB0000001", "HMDB0000001", "HMDB0000002", "HMDB0000003", "HMDB0000005"),
  'Metabolite_Name' = c("Alanine", "Alanine", "Glucose", "Creatinine", "Missing_Metab"),
  'Sample_Type' = c("Urine", "Plasma", "Plasma", "Urine", "Plasma"),
  'Min_Age(year)' = c(0, 11, 0, 0, 0),
  'Max_Age(year)' = c(99, 99, 99, 99, 99),
  'Min_Concentration(Healthy)' = c(500, 150, 4.0, 50, 200),
  'Max_Concentration(Healthy)' = c(1000, 300, 7.0, 100, 400),
  check.names = FALSE
)

# User's Input
user_data <- data.frame(
  Sample_A = c(250, 6.0, 120, 50),
  Sample_B = c(160, 12.0, 60, 50),
  row.names = c("HMDB0000001", "HMDB0000002", "HMDB0000003", "HMDB0000004")
)

# Age and Sample Type
age_vector <- c(5, 20)
sample_type_vector <- c("Urine", "Plasma") # Sample A is Urine, Sample B is Plasma

# Test Case: Matching by HMDB_ID
results_id <- MetabAnalysis(
  data_input = user_data,
  age = age_vector,
  sample_type = sample_type_vector,
  match_by = "HMDB_ID",
  ref_data_override = mock_reference_data
)
print(results_id)

# Test Case : Matching by Metabolite_Name
# Rename row names to test the 'Metabolite_Name' matching path
user_data_name <- user_data
row.names(user_data_name) <- c("Alanine", "Glucose", "Creatinine", "Unknown_Metab")

results_name <- MetabAnalysis(
  data_input = user_data_name,
  age = age_vector,
  sample_type = sample_type_vector,
  match_by = "Metabolite_Name",
  ref_data_override = mock_reference_data
)
print(results_name)
}

}
\references{
\strong{HMDB Metabolite Reference Data}:
Wishart, D. S., et al. (2022). HMDB 5.0: The Human Metabolome Database for 2022.
Nucleic Acids Research, 50(D1), D1-D10. Retrieved from \href{https://hmdb.ca/}{HMDB}.

\strong{Debugging Assistance:}
Google. (2025). Gemini (v 2.0 Flash) [Large language model]. \href{https://gemini.google.com}{Gemini}
}
