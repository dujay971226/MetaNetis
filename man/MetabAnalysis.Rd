% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MetabAnalysis.R
\name{MetabAnalysis}
\alias{MetabAnalysis}
\title{Analyze Metabolite Concentrations Against Healthy Reference Ranges}
\usage{
MetabAnalysis(
  data_input,
  age,
  sample_type = NULL,
  match_by = c("HMDB_ID", "Metabolite_Name"),
  ref_data_override = NULL
)
}
\arguments{
\item{data_input}{A data frame or a character string representing the file path
to a CSV file containing metabolite concentrations. Rows must represent
individual metabolites, and \strong{the row names must be the metabolite identifiers}
(HMDB IDs or Metabolite Names). If names were used instead of IDS, please make sure
they match the reference data's name exactly(obtained by GetRefRanges()).
Columns represent samples.}

\item{age}{A numeric vector where each element represents the age (in years)
for the corresponding sample column in \code{data_input}. The length of this
vector must match the number of sample columns.}

\item{sample_type}{A character vector specifying the biospecimen type for each sample.
The length of this vector must match the number of samples.
(e.g., \code{"Blood/Serum/Plasma"}, \code{"Urine"}, \code{"CSF"}).}

\item{match_by}{A character string indicating whether the \strong{row names} in
\code{data_input} represent "HMDB_ID" (default) or "Metabolite_Name". Default
set to be "HMDB_ID".}

\item{ref_data_override}{An optional data frame to use as the reference, bypassing the \code{GetRefRanges()} call.}
}
\value{
A data frame with the same structure as \code{data_input} (rows as
  metabolites, columns as samples), where the numeric concentration values are
  replaced by character classifications: "Normal", "High", or "Low". If a
  metabolite cannot be matched or no age-appropriate reference is found,
  the classification will be "Missing Reference".
}
\description{
Compares a user-supplied metabolite concentration dataset against the
standardized healthy reference ranges provided by \code{GetRefRanges()}.
It returns a data frame showing the classification of each metabolite's
concentration in each sample as "Normal," "High," or "Low."
}
\details{
This function assumes the user data has been formatted so that metabolite
identifiers are used as \strong{row names} and all column values are numeric
concentrations for different samples. The function uses the \code{match_by}
parameter to determine which column in the reference table to match the row names against.

**Required Structure of \code{data_input}:**
\itemize{
  \item **Row Names:** Must be HMDB IDs (e.g., "HMDB0000001") or Metabolite Names (e.g., "Alanine").
  \item **Columns:** Must be numeric concentration values for each sample.
}

#' @examples
\dontrun{
# User metabolite data
user_data <- data.frame(
  Sample_A = c(250, 6.0, 120, 50), # Sample A age 5: Alanine is High (250 > 200)
  Sample_B = c(160, 12.0, 60, 50), # Sample B age 20: Alanine is Normal (160 is in 150-300)
  row.names = c("HMDB0001310", "HMDB0000002", "HMDB0000003", "HMDB0000004")
)

age_vector <- c(5, 20)

# --- Test Case Execution (Matching by HMDB_ID) ---
message("--- Analysis by HMDB_ID ---")
results_id <- MetabAnalysis(
  data_input = user_data,
  age = age_vector,
  match_by = "HMDB_ID"
)
print(results_id)

# --- Test Case Execution (Matching by Metabolite_Name) ---
# Rename row names for name matching test
user_data_name <- user_data
row.names(user_data_name) <- c("D-Alanine", "Glucose", "Creatinine", "ALT")

message("\n--- Analysis by Metabolite_Name ---")
# The function will issue a warning because "Unknown_Metab" is missing.
results_name <- MetabAnalysis(
  data_input = user_data_name,
  age = age_vector,
  match_by = "Metabolite_Name"
)
print(results_name)
}
}
